<!DOCTYPE html>
<html lang="en">
	<head>
		<% include partials/head %>

		<script>
		var counter = 1;

		function selectName(inputString, id){
			// Find the name in the actordropdown string and replace with 
			searchStr = "<option value='" + id + "'>";
			replaceStr = "<option value='" + id + "' selected>";
			var result = inputString.replace(searchStr, replaceStr);
			return result;
		}

		function addInput(divName){

			if(divName == 'dynamicRelationInput') {
				var newdiv = document.createElement('div');
          		newdiv.innerHTML = "<%= actor.name %> is related to <%- actordropdown %> as <input type='text' id='relTarget' name='relTarget[]'>";
          		document.getElementById(divName).appendChild(newdiv);
          	
			} else {
    	
        		var newdiv = document.createElement('div');
          		newdiv.innerHTML = "<input type='text' name='label'> <input type='text' name='value'>";
          		document.getElementById(divName).appendChild(newdiv);
          		counter++;
     		};
		}

	
		</script>
	</head>
	<body class="container">
		<header>
			<% include partials/header %>
		</header>
		
		<main>
			<div class="jumbotron">

			<div>
		 
           <% if(typeof(errorMessage) !== 'undefined') {%>
              <span><%= errorMessage %></span>
           <% } %>


		<form method="post" action="/actors/<%= actor._id %>">
		<input type="hidden" name="_method" value="put" />
		 
           <% if(typeof(errorMessage) !== 'undefined') {%>
              <span><%= errorMessage %></span>
           <% } %>
		 
           <div class="form-group">
		 	<% for (var key in actor) { %>
		 		<% if(key != '_id' && key != '') { %>
		 			<% if(key != 'actorTarget' && key != 'relTarget') { %>
		 				<label for="<%= key %>"><%= key %></label>
              			<input type="text" class="form-control" name="<%= key %>" id="<%= key %>" value="<%= actor[key] %>"/>
		 			<% } %>
		 		<% } %>
			<% } %>


			<hr>
			<p> Add new parameters
			<div id="dynamicInput">
          		<input type="text" id="label1" name="label"> <input type="text" id="value1" name="value"> 
     		</div>
     		<input type="button" value="+ parameter" onClick="addInput('dynamicInput');">

     		<hr>
     		<p> Relationships
     		<div id="dynamicRelationInput">
     		<% if(actor.actorTarget) {%>
			<% actor.actorTarget.forEach(function(el, index) { %>
				<%= actor.name %> is related to <%- actordropdown.replace("<option value='" + el + "'>", "<option value='" + el + "' selected>"); %> as <input type="text" id="relTarget[]" name="relTarget[]" value="<%= actor.relTarget[index] %>"></p>
			<% }); %>
			<% } %>
          		 <%= actor.name %> is related to <%- actordropdown %> as <input type="text" id="relTarget" name="relTarget[]">
     		</div>
     		<input type="button" value="+ relationship" onClick="addInput('dynamicRelationInput');">
		   
	          <p>
	             <button type="submit" name="submit" id="submit" class="btn btn-default">update</button>
	          </p>
			
			
	     </form>


	     <a href='/actors/delete/<%= actor._id %>'>delete actor</a>
		 	</main>
		
	<footer>
		<% include partials/footer %>
	</footer>
	</body>
</html>